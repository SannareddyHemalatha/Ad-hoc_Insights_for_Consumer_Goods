ğŸ­. ğ—£ğ—¿ğ—¼ğ˜ƒğ—¶ğ—±ğ—² ğ˜ğ—µğ—² ğ—¹ğ—¶ğ˜€ğ˜ ğ—¼ğ—³ ğ—ºğ—®ğ—¿ğ—¸ğ—²ğ˜ğ˜€ ğ—¶ğ—» ğ˜„ğ—µğ—¶ğ—°ğ—µ ğ—°ğ˜‚ğ˜€ğ˜ğ—¼ğ—ºğ—²ğ—¿ "ğ—”ğ˜ğ—¹ğ—¶ğ—¾ ğ—˜ğ˜…ğ—°ğ—¹ğ˜‚ğ˜€ğ—¶ğ˜ƒğ—²" ğ—¼ğ—½ğ—²ğ—¿ğ—®ğ˜ğ—²ğ˜€ ğ—¶ğ˜ğ˜€ ğ—¯ğ˜‚ğ˜€ğ—¶ğ—»ğ—²ğ˜€ğ˜€ ğ—¶ğ—» ğ˜ğ—µğ—² ğ—”ğ—£ğ—”ğ—– ğ—¿ğ—²ğ—´ğ—¶ğ—¼ğ—».

SELECT market
FROM dim_customer
WHERE customer= 'Atliq Exclusive' AND region= 'APAC'
GROUP BY market;


ğŸ®. ğ—ªğ—µğ—®ğ˜ ğ—¶ğ˜€ ğ˜ğ—µğ—² ğ—½ğ—²ğ—¿ğ—°ğ—²ğ—»ğ˜ğ—®ğ—´ğ—² ğ—¼ğ—³ ğ˜‚ğ—»ğ—¶ğ—¾ğ˜‚ğ—² ğ—½ğ—¿ğ—¼ğ—±ğ˜‚ğ—°ğ˜ ğ—¶ğ—»ğ—°ğ—¿ğ—²ğ—®ğ˜€ğ—² ğ—¶ğ—» ğŸ®ğŸ¬ğŸ®ğŸ­ ğ˜ƒğ˜€. ğŸ®ğŸ¬ğŸ®ğŸ¬?

SELECT
A.unq_20 AS unique_products_2020,
B.unq_21 AS unique_products_2021,
ROUND((B.unq_21-A.unq_20)*100/A.unq_20,2) as pct_change
FROM 
(
(SELECT COUNT(DISTINCT(product_code)) as unq_20
FROM fact_sales_monthly
WHERE fiscal_year = 2020) A,

(SELECT COUNT(DISTINCT(product_code)) as unq_21
FROM fact_sales_monthly
WHERE fiscal_year = 2021) B
);


ğŸ¯. ğ—£ğ—¿ğ—¼ğ˜ƒğ—¶ğ—±ğ—² ğ—® ğ—¿ğ—²ğ—½ğ—¼ğ—¿ğ˜ ğ˜„ğ—¶ğ˜ğ—µ ğ—®ğ—¹ğ—¹ ğ˜ğ—µğ—² ğ˜‚ğ—»ğ—¶ğ—¾ğ˜‚ğ—² ğ—½ğ—¿ğ—¼ğ—±ğ˜‚ğ—°ğ˜ ğ—°ğ—¼ğ˜‚ğ—»ğ˜ğ˜€ ğ—³ğ—¼ğ—¿ ğ—²ğ—®ğ—°ğ—µ ğ˜€ğ—²ğ—´ğ—ºğ—²ğ—»ğ˜ ğ—®ğ—»ğ—± ğ˜€ğ—¼ğ—¿ğ˜ ğ˜ğ—µğ—²ğ—º ğ—¶ğ—» ğ—±ğ—²ğ˜€ğ—°ğ—²ğ—»ğ—±ğ—¶ğ—»ğ—´ ğ—¼ğ—¿ğ—±ğ—²ğ—¿ ğ—¼ğ—³ ğ—½ğ—¿ğ—¼ğ—±ğ˜‚ğ—°ğ˜ ğ—°ğ—¼ğ˜‚ğ—»ğ˜ğ˜€.

SELECT
segment,
COUNT(product) as product_count
FROM dim_product
GROUP BY segment
ORDER BY product_count DESC;


ğŸ°. ğ—™ğ—¼ğ—¹ğ—¹ğ—¼ğ˜„-ğ˜‚ğ—½: ğ—ªğ—µğ—¶ğ—°ğ—µ ğ˜€ğ—²ğ—´ğ—ºğ—²ğ—»ğ˜ ğ—µğ—®ğ—± ğ˜ğ—µğ—² ğ—ºğ—¼ğ˜€ğ˜ ğ—¶ğ—»ğ—°ğ—¿ğ—²ğ—®ğ˜€ğ—² ğ—¶ğ—» ğ˜‚ğ—»ğ—¶ğ—¾ğ˜‚ğ—² ğ—½ğ—¿ğ—¼ğ—±ğ˜‚ğ—°ğ˜ğ˜€ ğ—¶ğ—» ğŸ®ğŸ¬ğŸ®ğŸ­ ğ˜ƒğ˜€ ğŸ®ğŸ¬ğŸ®ğŸ¬?

WITH cte1 AS 
(SELECT
segment as s1,
COUNT(DISTINCT(s.product_code)) AS cnt1
FROM dim_product p, fact_sales_monthly s
WHERE p.product_code=s.product_code
GROUP BY p.segment, s.fiscal_year
HAVING s.fiscal_year='2020'),

cte2 AS
(SELECT
segment AS s2,
COUNT(DISTINCT(s.product_code)) AS cnt2
FROM dim_product p, fact_sales_monthly s
WHERE p.product_code=s.product_code
GROUP BY p.segment, s.fiscal_year
HAVING s.fiscal_year='2021')

SELECT
cte1.s1 AS segment,
cte1.cnt1 AS product_count_2020,
cte2.cnt2 AS product_count_2021,
(cte2.cnt2-cte1.cnt1) AS difference
FROM cte1, cte2
WHERE cte1.s1=cte2.s2;


ğŸ±. ğ—šğ—²ğ˜ ğ˜ğ—µğ—² ğ—½ğ—¿ğ—¼ğ—±ğ˜‚ğ—°ğ˜ğ˜€ ğ˜ğ—µğ—®ğ˜ ğ—µğ—®ğ˜ƒğ—² ğ˜ğ—µğ—² ğ—µğ—¶ğ—´ğ—µğ—²ğ˜€ğ˜ ğ—®ğ—»ğ—± ğ—¹ğ—¼ğ˜„ğ—²ğ˜€ğ˜ ğ—ºğ—®ğ—»ğ˜‚ğ—³ğ—®ğ—°ğ˜ğ˜‚ğ—¿ğ—¶ğ—»ğ—´ ğ—°ğ—¼ğ˜€ğ˜ğ˜€.

(SELECT
m.product_code,
p.product,
m.manufacturing_cost
FROM fact_manufacturing_cost m, dim_product p
WHERE m.product_code=p.product_code
ORDER BY m.manufacturing_cost DESC
LIMIT 1) -- Highest cost product
UNION
(SELECT
m.product_code,
p.product,
m.manufacturing_cost
FROM fact_manufacturing_cost m, dim_product p
WHERE m.product_code=p.product_code
ORDER BY m.manufacturing_cost ASC
LIMIT 1) -- Lowest cost product;


ğŸ². ğ—šğ—²ğ—»ğ—²ğ—¿ğ—®ğ˜ğ—² ğ—® ğ—¿ğ—²ğ—½ğ—¼ğ—¿ğ˜ ğ˜„ğ—µğ—¶ğ—°ğ—µ ğ—°ğ—¼ğ—»ğ˜ğ—®ğ—¶ğ—»ğ˜€ ğ˜ğ—µğ—² ğ˜ğ—¼ğ—½ ğŸ± ğ—°ğ˜‚ğ˜€ğ˜ğ—¼ğ—ºğ—²ğ—¿ğ˜€ ğ˜„ğ—µğ—¼ ğ—¿ğ—²ğ—°ğ—²ğ—¶ğ˜ƒğ—²ğ—± ğ—®ğ—» ğ—®ğ˜ƒğ—²ğ—¿ğ—®ğ—´ğ—² ğ—µğ—¶ğ—´ğ—µ ğ—½ğ—¿ğ—²_ğ—¶ğ—»ğ˜ƒğ—¼ğ—¶ğ—°ğ—²_ğ—±ğ—¶ğ˜€ğ—°ğ—¼ğ˜‚ğ—»ğ˜_ğ—½ğ—°ğ˜ ğ—³ğ—¼ğ—¿ ğ˜ğ—µğ—² ğ—³ğ—¶ğ˜€ğ—°ğ—®ğ—¹ ğ˜†ğ—²ğ—®ğ—¿ ğŸ®ğŸ¬ğŸ®ğŸ­ ğ—®ğ—»ğ—± ğ—¶ğ—» ğ˜ğ—µğ—²
ğ—œğ—»ğ—±ğ—¶ğ—®ğ—» ğ—ºğ—®ğ—¿ğ—¸ğ—²ğ˜.

SELECT
pr.customer_code, c.customer,
pr.pre_invoice_discount_pct AS average_discount_percentage
FROM fact_pre_invoice_deductions pr
JOIN dim_customer c
USING (customer_code)
WHERE pre_invoice_discount_pct > (SELECT AVG(pre_invoice_discount_pct) FROM fact_pre_invoice_deductions)
AND c.market='India'
ORDER BY average_discount_percentage DESC
LIMIT 5;


ğŸ³. ğ—šğ—²ğ˜ ğ˜ğ—µğ—² ğ—°ğ—¼ğ—ºğ—½ğ—¹ğ—²ğ˜ğ—² ğ—¿ğ—²ğ—½ğ—¼ğ—¿ğ˜ ğ—¼ğ—³ ğ˜ğ—µğ—² ğ—šğ—¿ğ—¼ğ˜€ğ˜€ ğ˜€ğ—®ğ—¹ğ—²ğ˜€ ğ—®ğ—ºğ—¼ğ˜‚ğ—»ğ˜ ğ—³ğ—¼ğ—¿ ğ˜ğ—µğ—² ğ—°ğ˜‚ğ˜€ğ˜ğ—¼ğ—ºğ—²ğ—¿ â€œğ—”ğ˜ğ—¹ğ—¶ğ—¾ ğ—˜ğ˜…ğ—°ğ—¹ğ˜‚ğ˜€ğ—¶ğ˜ƒğ—²â€ ğ—³ğ—¼ğ—¿ ğ—²ğ—®ğ—°ğ—µ ğ—ºğ—¼ğ—»ğ˜ğ—µ . ğ—§ğ—µğ—¶ğ˜€ ğ—®ğ—»ğ—®ğ—¹ğ˜†ğ˜€ğ—¶ğ˜€ ğ—µğ—²ğ—¹ğ—½ğ˜€ ğ˜ğ—¼ ğ—´ğ—²ğ˜ ğ—®ğ—» ğ—¶ğ—±ğ—²ğ—® ğ—¼ğ—³ ğ—¹ğ—¼ğ˜„ ğ—®ğ—»ğ—±
ğ—µğ—¶ğ—´ğ—µ-ğ—½ğ—²ğ—¿ğ—³ğ—¼ğ—¿ğ—ºğ—¶ğ—»ğ—´ ğ—ºğ—¼ğ—»ğ˜ğ—µğ˜€ ğ—®ğ—»ğ—± ğ˜ğ—®ğ—¸ğ—² ğ˜€ğ˜ğ—¿ğ—®ğ˜ğ—²ğ—´ğ—¶ğ—° ğ—±ğ—²ğ—°ğ—¶ğ˜€ğ—¶ğ—¼ğ—»ğ˜€.

SELECT
CONCAT(MONTHNAME(s.date), ' (', YEAR(s.date), ')') AS month,
s.fiscal_year,
ROUND(SUM(s.sold_quantity*g.gross_price),2) as gross_sales_amount
FROM fact_sales_monthly s
JOIN fact_gross_price g
ON s.product_code=g.product_code
JOIN dim_customer c
ON s.customer_code=c.customer_code
WHERE c.customer='Atliq Exclusive'
GROUP BY month, s.fiscal_year
ORDER BY s.fiscal_year;


ğŸ´. ğ—œğ—» ğ˜„ğ—µğ—¶ğ—°ğ—µ ğ—¾ğ˜‚ğ—®ğ—¿ğ˜ğ—²ğ—¿ ğ—¼ğ—³ ğŸ®ğŸ¬ğŸ®ğŸ¬, ğ—´ğ—¼ğ˜ ğ˜ğ—µğ—² ğ—ºğ—®ğ˜…ğ—¶ğ—ºğ˜‚ğ—º ğ˜ğ—¼ğ˜ğ—®ğ—¹_ğ˜€ğ—¼ğ—¹ğ—±_ğ—¾ğ˜‚ğ—®ğ—»ğ˜ğ—¶ğ˜ğ˜†?

SELECT
CASE
WHEN date BETWEEN '2019-09-01' AND '2019-11-01' THEN 'Q1'
WHEN date BETWEEN '2019-12-01' AND '2020-02-01' THEN 'Q2'
WHEN date BETWEEN '2020-03-01' AND '2020-05-01' THEN 'Q3'
WHEN date BETWEEN '2020-06-01' AND '2020-08-01' THEN 'Q4'
END AS quarters,
ROUND(SUM(sold_quantity)/1000000,2) AS total_sold_quantity_in_mln
FROM fact_sales_monthly
WHERE fiscal_year=2020
GROUP BY quarters
ORDER BY total_sold_quantity_in_mln DESC;


ğŸµ. ğ—ªğ—µğ—¶ğ—°ğ—µ ğ—°ğ—µğ—®ğ—»ğ—»ğ—²ğ—¹ ğ—µğ—²ğ—¹ğ—½ğ—²ğ—± ğ˜ğ—¼ ğ—¯ğ—¿ğ—¶ğ—»ğ—´ ğ—ºğ—¼ğ—¿ğ—² ğ—´ğ—¿ğ—¼ğ˜€ğ˜€ ğ˜€ğ—®ğ—¹ğ—²ğ˜€ ğ—¶ğ—» ğ˜ğ—µğ—² ğ—³ğ—¶ğ˜€ğ—°ğ—®ğ—¹ ğ˜†ğ—²ğ—®ğ—¿ ğŸ®ğŸ¬ğŸ®ğŸ­ ğ—®ğ—»ğ—± ğ˜ğ—µğ—² ğ—½ğ—²ğ—¿ğ—°ğ—²ğ—»ğ˜ğ—®ğ—´ğ—² ğ—¼ğ—³ ğ—°ğ—¼ğ—»ğ˜ğ—¿ğ—¶ğ—¯ğ˜‚ğ˜ğ—¶ğ—¼ğ—»?

WITH cte1 AS (
SELECT c.channel, SUM(s.sold_quantity*g.gross_price) AS total_sales
FROM fact_sales_monthly s
JOIN dim_customer c ON s.customer_code=c.customer_code
JOIN fact_gross_price g ON s.product_code=g.product_code
WHERE s.fiscal_year=2021
GROUP BY c.channel
ORDER BY total_sales DESC)

SELECT channel, ROUND(total_sales/1000000,2) AS gross_sales_in_mln,
ROUND(total_sales/(SUM(total_sales) OVER())*100,2) AS percentage
FROM cte1;


ğŸ­ğŸ¬. ğ—šğ—²ğ˜ ğ˜ğ—µğ—² ğ—§ğ—¼ğ—½ ğŸ¯ ğ—½ğ—¿ğ—¼ğ—±ğ˜‚ğ—°ğ˜ğ˜€ ğ—¶ğ—» ğ—²ğ—®ğ—°ğ—µ ğ—±ğ—¶ğ˜ƒğ—¶ğ˜€ğ—¶ğ—¼ğ—» ğ˜ğ—µğ—®ğ˜ ğ—µğ—®ğ˜ƒğ—² ğ—® ğ—µğ—¶ğ—´ğ—µ ğ˜ğ—¼ğ˜ğ—®ğ—¹_ğ˜€ğ—¼ğ—¹ğ—±_ğ—¾ğ˜‚ğ—®ğ—»ğ˜ğ—¶ğ˜ğ˜† ğ—¶ğ—» ğ˜ğ—µğ—² ğ—³ğ—¶ğ˜€ğ—°ğ—®ğ—¹_ğ˜†ğ—²ğ—®ğ—¿ ğŸ®ğŸ¬ğŸ®ğŸ­?

WITH cte1 AS (
SELECT
p.division, s.product_code, p.product,
SUM(s.sold_quantity) as total_sold_quantity
FROM fact_sales_monthly s
JOIN dim_product P ON s.product_code=p.product_code
WHERE s.fiscal_year = 2021 
GROUP BY s.product_code, division, P.product),

cte2 AS (
SELECT division, product_code, product, total_sold_quantity,
RANK() OVER(PARTITION BY division ORDER BY total_sold_quantity DESC) AS 'rank_order'
FROM cte1)

SELECT cte1.division, cte1.product_code, cte1.product, cte2.total_sold_quantity, cte2.rank_order
FROM cte1 JOIN cte2 ON cte1.product_code=cte2.product_code
WHERE cte2.rank_order IN (1,2,3);
